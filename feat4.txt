Filter feature 4 implemented

Optimised feature 4